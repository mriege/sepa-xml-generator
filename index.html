<!DOCTYPE html>
<html lang="de">
<head>
    <!-- ============================================================
         SEPA-XML Generator - Hauptseite
         ============================================================
         Kostenloser, datenschutzfreundlicher SEPA-XML Generator fuer
         Lastschriften (pain.008) und Ueberweisungen (pain.001).

         Architektur:
         - index.html  ‚Üí UI-Struktur (diese Datei)
         - style.css   ‚Üí Styling, Animationen, responsive Design
         - sepa.min.js ‚Üí SEPA-Bibliothek (ISO 20022 XML-Erzeugung)
         - sepa-generator.js ‚Üí Anwendungslogik (Event-Handling,
                               Validierung, Datentransformation)

         Alle Daten werden ausschliesslich im Browser verarbeitet.
         Es findet keinerlei Kommunikation mit externen Servern statt.
         ============================================================ -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO: Titel mit relevanten Keywords fuer Suchmaschinen -->
    <title>Kostenloser SEPA-XML Generator | Lastschrift & √úberweisung | 100% Datenschutz</title>

    <!-- SEO: Meta-Beschreibung fuer Google-Suchergebnisse (max. ~160 Zeichen) -->
    <meta name="description" content="Erstellen Sie SEPA-XML-Dateien f√ºr Lastschriften und √úberweisungen kostenlos und sicher. Keine Anmeldung, 100% datenschutzkonform, alle Daten bleiben in Ihrem Browser. Einfach, schnell und DSGVO-konform.">

    <!-- SEO: Keywords fuer Suchmaschinen-Indexierung -->
    <meta name="keywords" content="SEPA-XML Generator, SEPA Lastschrift erstellen, SEPA √úberweisung, XML Generator kostenlos, SEPA pain.008, SEPA pain.001, Sammel√ºberweisung, Sammellastschrift, DSGVO konform, datenschutzfreundlich">
    <meta name="author" content="Webexperte.Berlin">
    <meta name="robots" content="index, follow">

    <!-- Open Graph Meta-Tags fuer Social-Media-Vorschauen (Facebook, LinkedIn etc.) -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Kostenloser SEPA-XML Generator - 100% Datenschutz">
    <meta property="og:description" content="Erstellen Sie SEPA-XML-Dateien f√ºr Lastschriften und √úberweisungen. Kostenlos, sicher und ohne Anmeldung.">

    <!-- Favicon: Inline-SVG mit Euro-Emoji als Browser-Tab-Icon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üí∂</text></svg>">

    <!-- Stylesheet: Alle visuellen Styles, Animationen und responsive Breakpoints -->
    <link rel="stylesheet" href="style.css">

    <!-- SheetJS (XLSX): Externe Bibliothek zum Lesen/Schreiben von Excel-Dateien (.xlsx/.xls) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- SEPA-Bibliothek: Erzeugt ISO 20022 XML-Dokumente (pain.001 / pain.008) -->
    <script src="sepa.min.js"></script>
</head>
<body>

    <!-- ============================================================
         HERO-BEREICH
         ============================================================
         Erster sichtbarer Bereich der Seite. Enthaelt:
         - Datenschutz-Badge (gruenes Pill-Label oben)
         - Hauptueberschrift und Untertitel
         - 4 Feature-Karten (Lokal, Sofort, Kostenlos, Bankgeprueft)
         - Call-to-Action Button (scrollt zu #start)
         - Trust-Indikatoren (Datenschutz, SEPA-konform, Benutzerfreundlich)
         ============================================================ -->
    <div class="hero-section">
            <div class="hero-content">

                <!-- Datenschutz-Badge: Gr√ºnes Pill-Label mit Schloss-Icon, pulsierende Animation -->
                <div class="hero-badge">
                    <!-- SVG: Schloss-Symbol (Bootstrap Icons) -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                    </svg>
                    <span>100% Datenschutz - DSGVO-konform</span>
                </div>

                <!-- Hauptueberschrift der Seite -->
                <h1>SEPA-XML Generator</h1>
                <p class="hero-subtitle">Erstellen Sie professionelle SEPA-XML-Dateien f√ºr Lastschriften und √úberweisungen ‚Äì kostenlos, einfach und sicher</p>

                <!-- Feature-Grid: 4 Karten mit den Hauptvorteilen der Anwendung -->
                <div class="hero-features">
                    <!-- Feature 1: Datenschutz - Lokale Verarbeitung -->
                    <div class="hero-feature">
                        <div class="feature-icon">üîí</div>
                        <div class="feature-text">
                            <strong>Vollst√§ndig lokal</strong>
                            <span>Alle Daten bleiben in Ihrem Browser</span>
                        </div>
                    </div>
                    <!-- Feature 2: Keine Registrierung noetig -->
                    <div class="hero-feature">
                        <div class="feature-icon">‚ö°</div>
                        <div class="feature-text">
                            <strong>Sofort einsatzbereit</strong>
                            <span>Keine Registrierung erforderlich</span>
                        </div>
                    </div>
                    <!-- Feature 3: Kostenlos und unbegrenzt nutzbar -->
                    <div class="hero-feature">
                        <div class="feature-icon">üíØ</div>
                        <div class="feature-text">
                            <strong>Kostenlos</strong>
                            <span>Unbegrenzte Nutzung, keine Geb√ºhren</span>
                        </div>
                    </div>
                    <!-- Feature 4: Kompatibel mit allen gaengigen Banking-Systemen -->
                    <div class="hero-feature">
                        <div class="feature-icon">‚úÖ</div>
                        <div class="feature-text">
                            <strong>Bankgepr√ºft</strong>
                            <span>Alle SEPA-Standards erf√ºllt</span>
                        </div>
                    </div>
                </div>

                <!-- Call-to-Action: Scrollt zum Anker #start (3-Schritte-Uebersicht) -->
                <div class="hero-cta">
                    <a href="#start" class="cta-button">
                        <span>Jetzt SEPA-XML erstellen</span>
                        <!-- SVG: Pfeil-nach-rechts (Bootstrap Icons) -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8z"/>
                        </svg>
                    </a>
                </div>
            </div>

            <!-- ============================================================
                 TRUST-INDIKATOREN
                 ============================================================
                 Drei Vertrauens-Karten unterhalb des Hero-Bereichs.
                 Weisser Hintergrund mit abgerundeten Ecken, ueberlappt
                 optisch den Hero-Bereich durch negativen Margin.
                 ============================================================ -->
            <div class="trust-section">
                <!-- Trust 1: Keine Datenuebertragung -->
                <div class="trust-item">
                    <!-- SVG: Schloss-Symbol -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                    </svg>
                    <div>
                        <strong>Keine Daten√ºbertragung</strong>
                        <p>Ihre Bankdaten verlassen niemals Ihren Computer</p>
                    </div>
                </div>
                <!-- Trust 2: SEPA-Standardkonformitaet -->
                <div class="trust-item">
                    <!-- SVG: Haekchen im Kreis -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05z"/>
                    </svg>
                    <div>
                        <strong>SEPA-konform</strong>
                        <p>Alle pain.008 und pain.001 Formate unterst√ºtzt</p>
                    </div>
                </div>
                <!-- Trust 3: Einsteigerfreundlichkeit -->
                <div class="trust-item">
                    <!-- SVG: Smiley-Gesicht -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zM7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5zM4.285 9.567a.5.5 0 0 1 .683.183A3.498 3.498 0 0 0 8 11.5a3.498 3.498 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.498 4.498 0 0 1 8 12.5a4.498 4.498 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683zM10 8c-.552 0-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5S10.552 8 10 8z"/>
                    </svg>
                    <div>
                        <strong>Benutzerfreundlich</strong>
                        <p>Auch f√ºr Einsteiger ohne Vorkenntnisse geeignet</p>
                    </div>
                </div>
            </div>
        </div>

    <!-- ============================================================
         HAUPTCONTAINER
         ============================================================
         Zentrierter Container (max-width: 1200px) fuer den gesamten
         Anwendungsinhalt unterhalb des Hero-Bereichs.
         ============================================================ -->
    <div class="container">

        <!-- ============================================================
             3-SCHRITTE-UEBERSICHT
             ============================================================
             Anker #start als Sprungziel fuer den CTA-Button.
             Zeigt die drei Hauptschritte als Vorschaukarten:
             1. Zahlungsart waehlen
             2. Daten eingeben
             3. XML erstellen
             ============================================================ -->
        <header id="start">
            <h2>So funktioniert's ‚Äì in 3 einfachen Schritten</h2>
            <div class="steps-overview">
                <div class="step-preview">
                    <div class="step-preview-number">1</div>
                    <h3>Zahlungsart w√§hlen</h3>
                    <p>Lastschrift zum Einziehen oder √úberweisung zum Auszahlen</p>
                </div>
                <div class="step-preview">
                    <div class="step-preview-number">2</div>
                    <h3>Daten eingeben</h3>
                    <p>Per Excel-Upload oder manuelle Eingabe</p>
                </div>
                <div class="step-preview">
                    <div class="step-preview-number">3</div>
                    <h3>XML erstellen</h3>
                    <p>Datei generieren und bei Ihrer Bank hochladen</p>
                </div>
            </div>
        </header>

        <main>

            <!-- ============================================================
                 SCHRITT 1: ZAHLUNGSART WAEHLEN
                 ============================================================
                 Zwei grosse Auswahlkarten fuer Lastschrift (directDebit)
                 und Ueberweisung (transfer).

                 JavaScript-Logik (sepa-generator.js):
                 - Klick auf eine Karte setzt currentPaymentType
                 - Zeigt/versteckt die zugehoerigen Konfigurationsfelder
                 - Aktualisiert die pain-Format-Optionen im Select
                 - Aktualisiert Labels und Spaltennamen in der Vorschau
                 ============================================================ -->
            <div class="step-section">
                <div class="step-header">
                    <span class="step-number">1</span>
                    <h2>Was m√∂chten Sie tun?</h2>
                </div>
                <p class="step-description">W√§hlen Sie, ob Sie Geld von Kunden einziehen oder an Empf√§nger √ºberweisen m√∂chten.</p>

                <div class="payment-type-buttons">
                    <!--
                        Lastschrift-Button:
                        - data-type="directDebit" wird von JS ausgelesen
                        - .active-Klasse zeigt Auswahlstatus (gruenes Haekchen via CSS ::before)
                        - Tooltip erklaert den Unterschied zu Ueberweisungen
                    -->
                    <button id="directDebitBtn" class="payment-type-btn active" data-type="directDebit">
                        <!-- SVG: Kreditkarten-Symbol (Lastschrift) -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v1h14V4a1 1 0 0 0-1-1H2zm13 4H1v5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V7z"/>
                            <path d="M2 10a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-1z"/>
                        </svg>
                        <span>Geld einziehen</span>
                        <strong>SEPA-Lastschrift</strong>
                        <small>F√ºr: Mitgliedsbeitr√§ge, Abos, wiederkehrende Zahlungen</small>
                        <div class="tooltip-icon" data-tooltip="Bei einer Lastschrift ziehen Sie Geld von den Konten Ihrer Kunden ein. Sie ben√∂tigen daf√ºr ein Lastschriftmandat und eine Gl√§ubiger-ID.">‚ìò</div>
                    </button>

                    <!--
                        Ueberweisungs-Button:
                        - data-type="transfer" wird von JS ausgelesen
                        - Wird aktiv bei Klick ‚Üí JS wechselt Formularbereiche
                    -->
                    <button id="transferBtn" class="payment-type-btn" data-type="transfer">
                        <!-- SVG: Geldschein-Symbol (Ueberweisung) -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1H1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z"/>
                            <path d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V5zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2H3z"/>
                        </svg>
                        <span>Geld √ºberweisen</span>
                        <strong>SEPA-√úberweisung</strong>
                        <small>F√ºr: Geh√§lter, Lieferanten, Auszahlungen</small>
                        <div class="tooltip-icon" data-tooltip="Bei einer √úberweisung senden Sie Geld von Ihrem Konto an andere. Ideal f√ºr Gehaltszahlungen oder Lieferantenrechnungen.">‚ìò</div>
                    </button>
                </div>
            </div>

            <!-- ============================================================
                 SCHRITT 2: KONFIGURATIONSBEREICH
                 ============================================================
                 Enthaelt alle Einstellungen fuer die XML-Generierung:
                 - SEPA-Format (pain-Version)
                 - Allgemeine Einstellungen (Initiator, Ausfuehrungsdatum)
                 - Lastschrift-spezifisch (Glaeubiger-Daten, Sequenztyp, Instrumentierung)
                 - Ueberweisungs-spezifisch (Auftraggeber-Daten)
                 - Konfigurationsverwaltung (Speichern/Laden als JSON)

                 Die Sichtbarkeit der Lastschrift/Ueberweisungs-Sektionen
                 wird per JavaScript gesteuert (display: none/block).
                 ============================================================ -->
            <div class="step-section config-section">
                <div class="step-header">
                    <span class="step-number">2</span>
                    <h2 id="configTitle">Ihre Daten eingeben</h2>
                </div>
                <p class="step-description">Geben Sie Ihre Bankdaten und weitere Einstellungen ein. Diese k√∂nnen Sie speichern und sp√§ter wiederverwenden.</p>

                <div id="configForm" class="config-form">

                    <!-- ========== SEPA-Format-Auswahl ==========
                         Dropdown mit allen unterstuetzten pain-Formaten.
                         Die Optionen werden per JavaScript dynamisch
                         gefiltert, je nach gewaehlter Zahlungsart:
                         - Lastschrift: pain.008.001.02, pain.008.001.08
                         - Ueberweisung: pain.001.001.03, .08, .09
                         Die empfohlene Version hat ein ‚≠ê und "selected".
                    -->
                    <div class="form-section">
                        <h3>
                            SEPA-Format
                            <span class="tooltip-icon" data-tooltip="Das Format bestimmt, welche Version des SEPA-Standards verwendet wird. Neuere Versionen sind empfohlen.">‚ìò</span>
                        </h3>
                        <div class="form-group">
                            <label for="painFormat">
                                Welche Version? *
                                <span class="help-text">Empfehlung: Die neueste Version</span>
                            </label>
                            <select id="painFormat" class="input-with-icon">
                                <!-- Lastschrift-Formate (pain.008) -->
                                <option value="pain.008.001.02">pain.008.001.02 (√Ñltere Version - hohe Kompatibilit√§t)</option>
                                <option value="pain.008.001.08" selected>pain.008.001.08 (Aktuelle Version - EMPFOHLEN) ‚≠ê</option>
                                <!-- Ueberweisungs-Formate (pain.001) -->
                                <option value="pain.001.001.03">pain.001.001.03 (√Ñltere Version - hohe Kompatibilit√§t)</option>
                                <option value="pain.001.001.08">pain.001.001.08 (Neuere Version)</option>
                                <option value="pain.001.001.09" selected>pain.001.001.09 (Neueste Version - EMPFOHLEN) ‚≠ê</option>
                            </select>
                            <div class="help-bubble">
                                <strong>Welche Version w√§hlen?</strong><br>
                                ‚Ä¢ Neueste Version (‚≠ê) funktioniert mit allen modernen Banking-Systemen<br>
                                ‚Ä¢ √Ñltere Versionen nur bei Kompatibilit√§tsproblemen
                            </div>
                        </div>
                    </div>

                    <!-- ========== Allgemeine Einstellungen ==========
                         Diese Felder gelten fuer beide Zahlungsarten:
                         - initiatorName: Erscheint als Ersteller im XML-Header (GrpHdr/InitgPty/Nm)
                         - executionDate: Ausfuehrungsdatum (ColltnDt bzw. ReqdExctnDt im XML)
                    -->
                    <div class="form-section">
                        <h3>
                            Allgemeine Einstellungen
                            <span class="tooltip-icon" data-tooltip="Diese Angaben gelten f√ºr alle Transaktionen in dieser Datei.">‚ìò</span>
                        </h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="initiatorName">
                                    Wer erstellt diese Zahlung? *
                                    <span class="help-text">Ihr Firmen- oder Vereinsname</span>
                                </label>
                                <input type="text" id="initiatorName" placeholder="z.B. Meine Firma GmbH" required class="input-with-validation" />
                                <div class="help-bubble">
                                    Dies ist der Name, der als Ersteller der SEPA-Datei erscheint.
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="executionDate">
                                    Wann soll ausgef√ºhrt werden?
                                    <span class="help-text">Optional - Standard ist heute</span>
                                </label>
                                <input type="date" id="executionDate" class="input-with-icon" />
                                <div class="help-bubble">
                                    <strong>Tipp:</strong> Bei Lastschriften mindestens 5 Tage Vorlauf einplanen!
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ========== Lastschrift-Einstellungen (Glaeubiger) ==========
                         Nur sichtbar wenn currentPaymentType === 'directDebit'.

                         Felder und ihre XML-Entsprechungen:
                         - creditorName  ‚Üí PmtInf/Cdtr/Nm
                         - creditorIBAN  ‚Üí PmtInf/CdtrAcct/Id/IBAN
                         - creditorBIC   ‚Üí PmtInf/CdtrAgt/FinInstnId/BIC (optional seit 2016)
                         - creditorId    ‚Üí PmtInf/CdtrSchmeId/Id/PrvtId/Othr/Id
                         - sequenceType  ‚Üí PmtInf/DrctDbtTxInf/PmtTpInf/SeqTp
                                           (FRST=Erstlastschrift, RCUR=Folgelastschrift,
                                            OOFF=Einmalig, FNAL=Letzte)
                         - localInstrumentation ‚Üí PmtInf/PmtTpInf/LclInstrm/Cd
                                                  (CORE=Basis, COR1=Schnell, B2B=Firmen)
                    -->
                    <div id="directDebitSettings" class="form-section">
                        <h3>
                            Empf√§nger-Daten (Gl√§ubiger)
                            <span class="tooltip-icon" data-tooltip="Das sind Ihre Daten - wohin das Geld flie√üt.">‚ìò</span>
                        </h3>
                        <div class="form-grid">
                            <!-- Glaeubiger-Name: Pflichtfeld, wird per JS validiert -->
                            <div class="form-group">
                                <label for="creditorName">
                                    Ihr Name/Firma *
                                    <span class="help-text">Empf√§nger der Lastschrift</span>
                                </label>
                                <input type="text" id="creditorName" placeholder="z.B. Meine Firma GmbH" required class="input-with-validation" />
                            </div>

                            <!-- Glaeubiger-IBAN: Wird per Mod-97 Checksumme validiert -->
                            <div class="form-group">
                                <label for="creditorIBAN">
                                    Ihre IBAN *
                                    <span class="help-text">Konto, auf das eingezogen wird</span>
                                </label>
                                <input type="text" id="creditorIBAN" placeholder="DE89 3704 0044 0532 0130 00" required class="input-with-validation" maxlength="34" />
                                <div class="validation-feedback"></div>
                            </div>

                            <!-- Glaeubiger-BIC: Optional seit SEPA-Verordnung 2016 -->
                            <div class="form-group">
                                <label for="creditorBIC">
                                    Ihre BIC
                                    <span class="help-text">Optional - nicht mehr zwingend n√∂tig</span>
                                </label>
                                <input type="text" id="creditorBIC" placeholder="COBADEFFXXX" maxlength="11" />
                                <div class="help-bubble">
                                    <strong>Gut zu wissen:</strong> Seit 2016 ist der BIC innerhalb Europas nicht mehr erforderlich.
                                </div>
                            </div>

                            <!-- Glaeubiger-ID: Wird per Mod-97 Checksumme validiert (Bundesbank-Format) -->
                            <div class="form-group">
                                <label for="creditorId">
                                    Ihre Gl√§ubiger-ID *
                                    <span class="help-text">Von der Bundesbank</span>
                                </label>
                                <input type="text" id="creditorId" placeholder="DE98ZZZ09999999999" required class="input-with-validation" />
                                <div class="help-bubble">
                                    <strong>Noch keine Gl√§ubiger-ID?</strong><br>
                                    Kostenlos beantragen bei der <a href="https://extranet.bundesbank.de/scp/" target="_blank">Bundesbank</a>
                                </div>
                            </div>

                            <!-- Sequenztyp: Bestimmt den Typ der Lastschrift im Mandatszyklus -->
                            <div class="form-group">
                                <label for="sequenceType">
                                    Welche Art von Lastschrift?
                                    <span class="help-text">Bei Unsicherheit: RCUR w√§hlen</span>
                                </label>
                                <select id="sequenceType" class="input-with-icon">
                                    <option value="FRST">üÜï FRST - Erste Lastschrift eines Mandats</option>
                                    <option value="RCUR" selected>üîÑ RCUR - Folgelastschrift (am h√§ufigsten) ‚≠ê</option>
                                    <option value="OOFF">1Ô∏è‚É£ OOFF - Einmalige Lastschrift</option>
                                    <option value="FNAL">üèÅ FNAL - Letzte Lastschrift eines Mandats</option>
                                </select>
                                <div class="help-bubble">
                                    <strong>Erkl√§rung:</strong><br>
                                    ‚Ä¢ <strong>FRST:</strong> Erste Abbuchung mit einem neuen Mandat<br>
                                    ‚Ä¢ <strong>RCUR:</strong> Alle weiteren Abbuchungen (Standard)<br>
                                    ‚Ä¢ <strong>OOFF:</strong> Nur eine einzige Abbuchung<br>
                                    ‚Ä¢ <strong>FNAL:</strong> Letzte Abbuchung vor Mandatsende
                                </div>
                            </div>

                            <!-- Lokale Instrumentierung: Bestimmt Verarbeitungsgeschwindigkeit und Zielgruppe -->
                            <div class="form-group">
                                <label for="localInstrumentation">
                                    Lastschrift-Geschwindigkeit
                                    <span class="help-text">CORE ist Standard</span>
                                </label>
                                <select id="localInstrumentation" class="input-with-icon">
                                    <option value="CORE" selected>üê¢ CORE - Basis (5 Tage Vorlauf) ‚≠ê</option>
                                    <option value="COR1">üêá COR1 - Schnell (1 Tag Vorlauf)</option>
                                    <option value="B2B">üè¢ B2B - Firmen (nur zwischen Unternehmen)</option>
                                </select>
                                <div class="help-bubble">
                                    <strong>Welche w√§hlen?</strong><br>
                                    ‚Ä¢ <strong>CORE:</strong> Standard f√ºr alle Kunden (Privat + Firma)<br>
                                    ‚Ä¢ <strong>COR1:</strong> Wenn es schnell gehen muss<br>
                                    ‚Ä¢ <strong>B2B:</strong> Nur zwischen Firmen, keine R√ºckgabe m√∂glich
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ========== Ueberweisungs-Einstellungen (Auftraggeber) ==========
                         Nur sichtbar wenn currentPaymentType === 'transfer'.
                         Initial per style="display: none;" versteckt.

                         Felder und ihre XML-Entsprechungen:
                         - debtorName ‚Üí PmtInf/Dbtr/Nm
                         - debtorIBAN ‚Üí PmtInf/DbtrAcct/Id/IBAN
                         - debtorBIC  ‚Üí PmtInf/DbtrAgt/FinInstnId/BIC (optional)
                    -->
                    <div id="transferSettings" class="form-section" style="display: none;">
                        <h3>
                            Auftraggeber-Daten
                            <span class="tooltip-icon" data-tooltip="Das sind Ihre Daten - von welchem Konto das Geld gesendet wird.">‚ìò</span>
                        </h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="debtorName">
                                    Ihr Name/Firma *
                                    <span class="help-text">Auftraggeber der √úberweisung</span>
                                </label>
                                <input type="text" id="debtorName" placeholder="z.B. Meine Firma GmbH" required class="input-with-validation" />
                            </div>

                            <div class="form-group">
                                <label for="debtorIBAN">
                                    Ihre IBAN *
                                    <span class="help-text">Konto, von dem √ºberwiesen wird</span>
                                </label>
                                <input type="text" id="debtorIBAN" placeholder="DE89 3704 0044 0532 0130 00" required class="input-with-validation" maxlength="34" />
                                <div class="validation-feedback"></div>
                            </div>

                            <div class="form-group">
                                <label for="debtorBIC">
                                    Ihre BIC
                                    <span class="help-text">Optional - nicht mehr zwingend n√∂tig</span>
                                </label>
                                <input type="text" id="debtorBIC" placeholder="COBADEFFXXX" maxlength="11" />
                                <div class="help-bubble">
                                    <strong>Gut zu wissen:</strong> Seit 2016 ist der BIC innerhalb Europas nicht mehr erforderlich.
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ========== Konfigurationsverwaltung ==========
                         Ermoeglicht das Speichern und Laden der Bankdaten als JSON-Datei.

                         Funktionen (sepa-generator.js):
                         - saveConfig: Sammelt alle Formularwerte ‚Üí JSON ‚Üí Blob ‚Üí Download
                         - loadConfig: Liest JSON-Datei ‚Üí setzt alle Formularwerte
                         - Auto-Save: Aenderungen werden automatisch in localStorage gespeichert

                         Das versteckte <input type="file"> wird per JS beim Klick
                         auf "Datei laden" ausgeloest (configFileInput.click()).
                    -->
                    <div class="config-management">
                        <div class="config-info">
                            <div class="info-icon">üíæ</div>
                            <div class="info-content">
                                <h4>Ihre Einstellungen speichern</h4>
                                <p>Speichern Sie Ihre Bankdaten und Konfiguration, damit Sie sie beim n√§chsten Mal nicht erneut eingeben m√ºssen. Die Daten werden als JSON-Datei heruntergeladen und k√∂nnen jederzeit wieder geladen werden.</p>
                                <ul class="info-list">
                                    <li><strong>Automatisch:</strong> Einstellungen werden im Browser gespeichert</li>
                                    <li><strong>Manuell:</strong> Als Datei speichern und auf anderen Ger√§ten nutzen</li>
                                    <li><strong>Sicher:</strong> Nur lokal, keine Cloud-Speicherung</li>
                                </ul>
                            </div>
                        </div>

                        <div class="button-group config-buttons">
                            <!-- Speichern-Button: Laedt aktuelle Konfiguration als JSON herunter -->
                            <button id="saveConfig" class="btn btn-primary">
                                <!-- SVG: Speichern/Download-Symbol -->
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M2 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H9.5a1 1 0 0 0-1 1v7.293l2.646-2.647a.5.5 0 0 1 .708.708l-3.5 3.5a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L7.5 9.293V2a2 2 0 0 1 2-2H14a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h2.5a.5.5 0 0 1 0 1H2z"/>
                                </svg>
                                <div class="btn-content">
                                    <span>Als Datei speichern</span>
                                    <small>JSON-Datei herunterladen</small>
                                </div>
                            </button>
                            <!-- Laden-Button: Oeffnet Dateiauswahl fuer JSON-Import -->
                            <button id="loadConfig" class="btn btn-secondary">
                                <!-- SVG: Upload-Symbol -->
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                                    <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
                                </svg>
                                <div class="btn-content">
                                    <span>Datei laden</span>
                                    <small>Gespeicherte Konfiguration</small>
                                </div>
                            </button>
                            <!-- Verstecktes File-Input fuer JSON-Import (per JS getriggert) -->
                            <input type="file" id="configFileInput" accept=".json" style="display: none;">
                        </div>
                    </div>
                </div>
            </div>

            <!-- ============================================================
                 SCHRITT 3: ZAHLUNGEN HINZUFUEGEN
                 ============================================================
                 Zwei Eingabemethoden als Tab-Interface:
                 1. Excel-Upload: Datei per Drag & Drop oder Klick hochladen
                 2. Manuelle Eingabe: Einzelne Transaktionen per Formular

                 Die Tab-Umschaltung erfolgt per JavaScript:
                 - Klick auf Tab ‚Üí .active-Klasse wechseln
                 - Zugehoeriger .input-method-content wird ein-/ausgeblendet
                 ============================================================ -->
            <div class="step-section">
                <div class="step-header">
                    <span class="step-number">3</span>
                    <h2>Zahlungen hinzuf√ºgen</h2>
                </div>
                <p class="step-description">W√§hlen Sie, wie Sie Ihre Zahlungen eingeben m√∂chten: per Excel-Datei oder manuell.</p>

                <!-- Tab-Buttons: Excel vs. Manuell -->
                <div class="input-method-tabs">
                    <button id="excelTab" class="input-tab active" data-method="excel">
                        <!-- SVG: Dokument-Symbol -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5z"/>
                            <path d="M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5L9.5 0zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"/>
                        </svg>
                        Excel-Datei hochladen
                    </button>
                    <button id="manualTab" class="input-tab" data-method="manual">
                        <!-- SVG: Stift-Symbol -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"/>
                        </svg>
                        Manuell eingeben
                    </button>
                </div>

                <!-- ========== Excel-Upload Methode ==========
                     Sichtbar wenn Excel-Tab aktiv (.active-Klasse).

                     Ablauf:
                     1. Vorlage herunterladen (downloadTemplate-Button)
                     2. Excel-Datei auswaehlen/droppen (excelFile-Input)
                     3. JS parst die Datei mit SheetJS (XLSX)
                     4. Transaktionen werden validiert und zur Vorschau hinzugefuegt
                -->
                <div id="excelInputMethod" class="input-method-content active">
                    <!-- Anleitung: 3-Schritte-Anleitung fuer den Excel-Upload -->
                    <div class="excel-instructions">
                        <div class="instruction-header">
                            <span class="instruction-icon">üìã</span>
                            <h3>Excel-Upload in 3 einfachen Schritten</h3>
                        </div>
                        <div class="instruction-steps">
                            <div class="instruction-step">
                                <span class="step-badge">1</span>
                                <div class="step-content">
                                    <strong>Vorlage laden</strong>
                                    <p>Excel-Vorlage mit Beispieldaten herunterladen</p>
                                </div>
                            </div>
                            <div class="instruction-step">
                                <span class="step-badge">2</span>
                                <div class="step-content">
                                    <strong>Daten eintragen</strong>
                                    <p>Zahlungsdaten in die Vorlage einf√ºgen</p>
                                </div>
                            </div>
                            <div class="instruction-step">
                                <span class="step-badge">3</span>
                                <div class="step-content">
                                    <strong>Hochladen</strong>
                                    <p>Datei per Drag & Drop oder Klick hochladen</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="upload-section">
                        <!-- Template-Download: Generiert eine Excel-Vorlage mit Beispieldaten via JS -->
                        <div class="template-download">
                            <button id="downloadTemplate" class="btn btn-template">
                                <!-- SVG: Dokument-Symbol -->
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5z"/>
                                    <path d="M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5L9.5 0zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"/>
                                </svg>
                                <div class="btn-content">
                                    <span>Excel-Vorlage herunterladen</span>
                                    <small>Mit Beispieldaten ausgef√ºllt</small>
                                </div>
                            </button>
                        </div>

                        <!-- Datei-Upload: Das <input type="file"> ist versteckt,
                             das <label> dient als gestylter Drag-&-Drop-Bereich.
                             JS behandelt sowohl Klick als auch Drag-&-Drop Events. -->
                        <div class="file-input-wrapper">
                            <input type="file" id="excelFile" accept=".xlsx,.xls" />
                            <label for="excelFile" class="file-label">
                                <!-- SVG: Upload-Symbol -->
                                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 16 16">
                                    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                                    <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
                                </svg>
                                <span>Ausgef√ºllte Excel-Datei hierher ziehen</span>
                                <small>oder klicken zum Ausw√§hlen</small>
                            </label>
                        </div>
                        <!-- Dateiname-Anzeige: Wird per JS befuellt nach erfolgreichem Upload -->
                        <div id="fileName" class="file-name"></div>
                    </div>
                </div>

                <!-- ========== Manuelle Eingabe-Methode ==========
                     Sichtbar wenn Manuell-Tab aktiv (.active-Klasse).

                     Formular fuer einzelne Transaktionen. Bei Klick auf
                     "Zahlung zur Liste hinzufuegen" wird die Transaktion
                     validiert und zur Vorschautabelle hinzugefuegt.

                     Das Label und Pflichtfeld fuer manualReference aendert sich
                     je nach Zahlungsart:
                     - Lastschrift: "Mandatsreferenz *" (Pflicht)
                     - Ueberweisung: "Referenz" (Optional)
                -->
                <div id="manualInputMethod" class="input-method-content">
                    <div class="manual-entry-form">
                        <h3>Neue Zahlung hinzuf√ºgen</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="manualName">Name *</label>
                                <input type="text" id="manualName" placeholder="Max Mustermann" required />
                            </div>

                            <div class="form-group">
                                <label for="manualIBAN">IBAN *</label>
                                <input type="text" id="manualIBAN" placeholder="DE89 3704 0044 0532 0130 00" required maxlength="34" />
                            </div>

                            <div class="form-group">
                                <label for="manualBIC">BIC</label>
                                <input type="text" id="manualBIC" placeholder="COBADEFFXXX (optional)" maxlength="11" />
                            </div>

                            <div class="form-group">
                                <label for="manualAmount">Betrag (‚Ç¨) *</label>
                                <input type="number" id="manualAmount" placeholder="45.00" step="0.01" min="0.01" max="999999999.99" required />
                            </div>

                            <!-- Verwendungszweck: Max. 140 Zeichen (SEPA-Standard) -->
                            <div class="form-group full-width">
                                <label for="manualRemittance">Verwendungszweck *</label>
                                <input type="text" id="manualRemittance" placeholder="z.B. Mitgliedsbeitrag Januar 2025" required maxlength="140" />
                            </div>

                            <!-- Referenz/Mandatsreferenz: Label wird per JS dynamisch geaendert -->
                            <div class="form-group">
                                <label for="manualReference" id="manualReferenceLabel">Mandatsreferenz *</label>
                                <input type="text" id="manualReference" placeholder="MAND-001-2025" required maxlength="35" />
                            </div>
                        </div>

                        <!-- Button: Fuegt die eingegebene Transaktion zur Vorschauliste hinzu -->
                        <button id="addManualEntry" class="btn btn-primary">
                            <!-- SVG: Plus-Symbol -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
                            </svg>
                            Zahlung zur Liste hinzuf√ºgen
                        </button>
                    </div>
                </div>
            </div>

            <!-- ============================================================
                 VORSCHAU-BEREICH
                 ============================================================
                 Wird per JavaScript eingeblendet (style.display = 'block'),
                 sobald mindestens eine Transaktion vorhanden ist.

                 Enthaelt:
                 - Zusammenfassung (Anzahl Transaktionen, Gesamtbetrag)
                 - Vorschautabelle mit allen Transaktionen
                 - "XML generieren" Button ‚Üí startet die XML-Erzeugung
                 - "Zuruecksetzen" Button ‚Üí leert alle Transaktionen

                 Die Tabellenspalte "Mandatsreferenz" wird per JS
                 dynamisch umbenannt zu "Referenz" bei Ueberweisungen.
                 Jede Tabellenzeile hat einen Loeschen-Button.
                 ============================================================ -->
            <div id="previewSection" class="preview-section" style="display: none;">
                <h2>Vorschau der Einz√ºge</h2>
                <!-- Zusammenfassung: "X Transaktionen | Gesamtbetrag: X.XX EUR" -->
                <div id="summary" class="summary"></div>
                <div class="table-wrapper">
                    <table id="previewTable">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Name</th>
                                <th>IBAN</th>
                                <th>Betrag</th>
                                <th>Verwendungszweck</th>
                                <!-- Spaltenname wird per JS geaendert: "Mandatsreferenz" oder "Referenz" -->
                                <th id="mandateColumn">Mandatsreferenz</th>
                                <th>Aktion</th>
                            </tr>
                        </thead>
                        <!-- Tabellenkoerper: Wird per JS dynamisch befuellt -->
                        <tbody id="previewBody">
                        </tbody>
                    </table>
                </div>
                <div class="button-group">
                    <!-- Hauptaktion: XML-Datei generieren und als Download anbieten -->
                    <button id="generateBtn" class="btn btn-primary">
                        <!-- SVG: Download-Symbol -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                            <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                        </svg>
                        SEPA-XML generieren und herunterladen
                    </button>
                    <!-- Zuruecksetzen: Leert die Transaktionsliste und versteckt die Vorschau -->
                    <button id="resetBtn" class="btn btn-secondary">Zur√ºcksetzen</button>
                </div>
            </div>

            <!-- ============================================================
                 FEHLERBEREICH
                 ============================================================
                 Wird per JavaScript eingeblendet wenn bei der XML-Generierung
                 oder beim Excel-Import ein Fehler auftritt.

                 Zeigt eine rote Fehlermeldung mit Shake-Animation.
                 Die Fehlermeldung wird per JS in #errorMessage geschrieben.
                 ============================================================ -->
            <div id="errorSection" class="error-section" style="display: none;">
                <div class="error-message">
                    <!-- SVG: Ausrufezeichen im Kreis -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                        <path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/>
                    </svg>
                    <span id="errorMessage"></span>
                </div>
            </div>

            <!-- ============================================================
                 HINWEISE ZUR EXCEL-DATEI
                 ============================================================
                 Informationsbereich mit den erwarteten Spaltenformaten
                 fuer Lastschrift und Ueberweisung.

                 Die Sichtbarkeit von #directDebitInfo und #transferInfo
                 wird per JS gesteuert (display: none/block).
                 ============================================================ -->
            <div class="info-section">
                <h3>Hinweise zur Excel-Datei</h3>
                <!-- Lastschrift-Info: Erwartete Spalten fuer pain.008 -->
                <div id="directDebitInfo">
                    <h4>F√ºr SEPA-Lastschrift:</h4>
                    <ul>
                        <li>Spaltenreihenfolge: <strong>Name, IBAN, BIC, Betrag, Verwendungszweck, Mandatsreferenz</strong></li>
                        <li>Die Mandatsreferenz ist erforderlich f√ºr jede Lastschrift</li>
                        <li>Doppelte Mandatsreferenzen werden automatisch gefiltert</li>
                    </ul>
                </div>
                <!-- Ueberweisungs-Info: Erwartete Spalten fuer pain.001 -->
                <div id="transferInfo" style="display: none;">
                    <h4>F√ºr SEPA-√úberweisung:</h4>
                    <ul>
                        <li>Spaltenreihenfolge: <strong>Name, IBAN, BIC, Betrag, Verwendungszweck, Referenz</strong></li>
                        <li>Die Referenz ist optional, wird aber empfohlen</li>
                        <li>BIC kann leer gelassen werden (wird dann als NOTPROVIDED markiert)</li>
                    </ul>
                </div>
                <p><strong>Allgemeine Hinweise:</strong></p>
                <ul>
                    <li>Die Daten m√ºssen sich im ersten Arbeitsblatt befinden (der Name ist beliebig)</li>
                    <li>Die erste Zeile enth√§lt die Kopfzeile</li>
                    <li>Leere Zeilen werden automatisch √ºbersprungen</li>
                    <li>Betr√§ge mit maximal 2 Dezimalstellen</li>
                </ul>
            </div>

            <!-- ============================================================
                 FAQ-BEREICH (Haeufig gestellte Fragen)
                 ============================================================
                 Akkordeon-Interface: Klick auf eine Frage zeigt/versteckt
                 die Antwort. Die Toggle-Logik ist in sepa-generator.js
                 implementiert (faqToggle Event-Listener).

                 Funktionsweise:
                 - Klick auf .faq-question ‚Üí togglet .active-Klasse auf .faq-item
                 - CSS-Transition: max-height 0 ‚Üí 1000px fuer sanfte Animation
                 - Plus-Symbol rotiert zu X bei .active (transform: rotate(45deg))
                 ============================================================ -->
            <div class="faq-section">
                <h2>H√§ufig gestellte Fragen</h2>

                <div class="faq-container">

                    <!-- FAQ 1: Unterschied Lastschrift vs. Ueberweisung -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Was ist der Unterschied zwischen SEPA-Lastschrift und SEPA-√úberweisung?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <p><strong>SEPA-Lastschrift:</strong> Sie ziehen Geld von Kundenkonten ein. Ben√∂tigt Mandate und Gl√§ubiger-ID. Ideal f√ºr wiederkehrende Zahlungen wie Mitgliedsbeitr√§ge.</p>
                                <p><strong>SEPA-√úberweisung:</strong> Sie √ºberweisen Geld an Empf√§nger. Keine Mandate erforderlich. Ideal f√ºr Gehaltszahlungen oder Lieferantenrechnungen.</p>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 2: Pain-Format-Empfehlung -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Welches Pain-Format soll ich verwenden?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <p><strong>Empfohlen:</strong></p>
                            <ul>
                                <li><strong>pain.008.001.08</strong> - Aktuellste Version f√ºr Lastschriften</li>
                                <li><strong>pain.001.001.09</strong> - Aktuellste Version f√ºr √úberweisungen</li>
                            </ul>
                            <p>√Ñltere Versionen werden f√ºr Kompatibilit√§t mit √§lteren Banking-Systemen unterst√ºtzt.</p>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 3: Glaeubiger-ID beantragen -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Wo bekomme ich eine Gl√§ubiger-Identifikationsnummer?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <p>Die Gl√§ubiger-ID k√∂nnen Sie kostenlos bei der <strong>Deutschen Bundesbank</strong> beantragen:</p>
                            <ul>
                                <li>Online: <a href="https://extranet.bundesbank.de/scp/" target="_blank" rel="noopener">Bundesbank Service Center</a></li>
                                <li>Die Bearbeitung dauert in der Regel 1-2 Werktage</li>
                                <li>Format: z.B. DE98ZZZ09999999999</li>
                            </ul>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 4: Sequenztypen erklaert -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Was bedeuten die Sequenztypen (FRST, RCUR, OOFF, FNAL)?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <ul>
                                    <li><strong>FRST</strong> (First) - Erste Lastschrift eines Mandats</li>
                                    <li><strong>RCUR</strong> (Recurring) - Folgelastschrift (h√§ufigste Option)</li>
                                    <li><strong>OOFF</strong> (One-Off) - Einmalige Lastschrift</li>
                                    <li><strong>FNAL</strong> (Final) - Letzte Lastschrift eines Mandats</li>
                                </ul>
                                <p>F√ºr wiederkehrende Zahlungen verwenden Sie RCUR.</p>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 5: Instrumentierungen (CORE/COR1/B2B) -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Was ist der Unterschied zwischen CORE, COR1 und B2B?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <ul>
                                    <li><strong>CORE</strong> - Basis-Lastschriftverfahren (5 Tage Vorlaufzeit)</li>
                                    <li><strong>COR1</strong> - Beschleunigte Lastschrift (1 Tag Vorlaufzeit)</li>
                                    <li><strong>B2B</strong> - Firmen-Lastschrift (nur zwischen Gesch√§ftskunden, keine R√ºckgabe m√∂glich)</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 6: BIC-Pflicht -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Ist der BIC (Bank Identifier Code) noch erforderlich?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <p>Nein, seit Februar 2016 ist der BIC innerhalb des SEPA-Raums <strong>nicht mehr zwingend erforderlich</strong>. Die IBAN allein reicht aus.</p>
                                <p>Die App setzt automatisch "NOTPROVIDED", wenn kein BIC angegeben wird.</p>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 7: Sicherheit und Datenschutz -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Wie sicher ist diese Anwendung?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <p><strong>Sehr sicher!</strong> Die gesamte Verarbeitung erfolgt lokal in Ihrem Browser:</p>
                            <ul>
                                <li>‚úÖ Keine Daten√ºbertragung an Server</li>
                                <li>‚úÖ Keine Speicherung sensibler Daten</li>
                                <li>‚úÖ Keine Cookies oder Tracking</li>
                                <li>‚úÖ Open Source - Code ist einsehbar</li>
                                <li>‚úÖ DSGVO-konform</li>
                            </ul>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 8: Banking-Kompatibilitaet -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Kann ich die XML-Datei direkt in mein Online-Banking hochladen?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <p>Ja! Die generierte XML-Datei entspricht dem SEPA-Standard und kann in den meisten Banking-Systemen hochgeladen werden:</p>
                            <ul>
                                <li>DATEV</li>
                                <li>Sparkassen-Banking</li>
                                <li>VR-NetWorld</li>
                                <li>Deutsche Bank Business Banking</li>
                                <li>Und viele weitere...</li>
                            </ul>
                            <p>Im Zweifelsfall pr√ºfen Sie mit Ihrer Bank das erforderliche Format.</p>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 9: Fehlerbehandlung bei Excel-Import -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Was passiert, wenn meine Excel-Datei Fehler enth√§lt?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <p>Die App f√ºhrt umfangreiche Validierungen durch:</p>
                            <ul>
                                <li>IBAN-Pr√ºfung (Checksumme)</li>
                                <li>BIC-Format-Validierung</li>
                                <li>Betrags-Validierung (0.01 - 999,999,999.99 EUR)</li>
                                <li>Pflichtfelder-Pr√ºfung</li>
                            </ul>
                            <p>Fehlerhafte Zeilen werden √ºbersprungen und in der Vorschau nicht angezeigt.</p>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 10: Mehrere Zahlungen mit unterschiedlichen Einstellungen -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Kann ich mehrere Zahlungen mit unterschiedlichen Daten erstellen?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <p>Ja! Sie k√∂nnen mehrere Payment-Info-Bl√∂cke mit unterschiedlichen Einstellungen erstellen:</p>
                            <ul>
                                <li>Unterschiedliche Ausf√ºhrungsdaten</li>
                                <li>Verschiedene Sequenztypen (FRST/RCUR/OOFF/FNAL)</li>
                                <li>Gemischte Lastschrifttypen (CORE/COR1/B2B)</li>
                            </ul>
                            <p>Aktuell unterst√ºtzt die App eine XML-Datei pro Durchlauf. F√ºr komplexere Szenarien generieren Sie mehrere Dateien.</p>
                            </div>
                        </div>
                    </div>

                    <!-- FAQ 11: Mandatsaenderungen -->
                    <div class="faq-item">
                        <div class="faq-question">
                            <h4>Unterst√ºtzt die App auch Mandate mit √Ñnderungen?</h4>
                            <span class="faq-toggle">+</span>
                        </div>
                        <div class="faq-answer">
                            <div class="faq-answer-content">
                                <p>Ja! Bei Mandats√§nderungen (z.B. Wechsel der Gl√§ubiger-ID) k√∂nnen Sie pro Transaktion √Ñnderungsinformationen angeben. Dies ist besonders relevant bei:</p>
                                <ul>
                                    <li>Fusion von Unternehmen</li>
                                    <li>√Ñnderung der Gl√§ubiger-Identifikationsnummer</li>
                                    <li>Kontowechsel des Gl√§ubigers</li>
                                </ul>
                                <p>F√ºr diesen erweiterten Use-Case kontaktieren Sie bitte den Support.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- ============================================================
             DATENSCHUTZ-BEREICH
             ============================================================
             Gruener Abschnitt mit detaillierten Datenschutz-Informationen.

             Enthaelt 4 Feature-Karten:
             1. Keine Server-Uebertragung
             2. DSGVO-konform
             3. Open Source (mit GitHub-Link)
             4. Keine Cookies

             Plus ein "Versprechen"-Block am Ende.
             Glasmorphismus-Design (backdrop-filter: blur).
             ============================================================ -->
        <div class="privacy-section">
            <div class="privacy-content">
                <div class="privacy-icon">üîí</div>
                <h2>100% Datenschutz garantiert</h2>
                <p class="privacy-lead">Ihre Bankdaten sind sicher ‚Äì versprochen!</p>

                <div class="privacy-features">
                    <!-- Datenschutz-Feature 1: Keine Server-Uebertragung -->
                    <div class="privacy-item">
                        <!-- SVG: Schloss-Symbol -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z"/>
                        </svg>
                        <h3>Keine Server-√úbertragung</h3>
                        <p>Alle Ihre Daten werden ausschlie√ülich in Ihrem Browser verarbeitet. Es findet <strong>keine √úbertragung</strong> zu unserem oder einem anderen Server statt.</p>
                    </div>

                    <!-- Datenschutz-Feature 2: DSGVO-Konformitaet -->
                    <div class="privacy-item">
                        <!-- SVG: Haekchen im Quadrat -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h12zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"/>
                            <path d="M10.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                        </svg>
                        <h3>DSGVO-konform</h3>
                        <p>Diese Anwendung erf√ºllt alle Anforderungen der <strong>Datenschutz-Grundverordnung (DSGVO)</strong>. Es werden keine personenbezogenen Daten gespeichert oder verarbeitet.</p>
                    </div>

                    <!-- Datenschutz-Feature 3: Open Source mit GitHub-Link -->
                    <div class="privacy-item">
                        <!-- SVG: Fragezeichen im Kreis -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
                            <path d="M5.255 5.786a.237.237 0 0 0 .241.247h.825c.138 0 .248-.113.266-.25.09-.656.54-1.134 1.342-1.134.686 0 1.314.343 1.314 1.168 0 .635-.374.927-.965 1.371-.673.489-1.206 1.06-1.168 1.987l.003.217a.25.25 0 0 0 .25.246h.811a.25.25 0 0 0 .25-.25v-.105c0-.718.273-.927 1.01-1.486.609-.463 1.244-.977 1.244-2.056 0-1.511-1.276-2.241-2.673-2.241-1.267 0-2.655.59-2.75 2.286zm1.557 5.763c0 .533.425.927 1.01.927.609 0 1.028-.394 1.028-.927 0-.552-.42-.94-1.029-.94-.584 0-1.009.388-1.009.94z"/>
                        </svg>
                        <h3>Open Source</h3>
                        <p>Der gesamte Quellcode ist <a href="https://github.com/mriege/sepa-xml-generator" target="_blank" rel="noopener" style="color: white; text-decoration: underline;">auf GitHub einsehbar</a>. Sie k√∂nnen selbst √ºberpr√ºfen, dass keine Daten das Ger√§t verlassen. <strong>Volle Transparenz</strong> garantiert.</p>
                    </div>

                    <!-- Datenschutz-Feature 4: Keine Cookies -->
                    <div class="privacy-item">
                        <!-- SVG: Schild-Symbol (kein Tracking) -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M5.338 1.59a61.44 61.44 0 0 0-2.837.856.481.481 0 0 0-.328.39c-.554 4.157.726 7.19 2.253 9.188a10.725 10.725 0 0 0 2.287 2.233c.346.244.652.42.893.533.12.057.218.095.293.118a.55.55 0 0 0 .101.025.615.615 0 0 0 .1-.025c.076-.023.174-.061.294-.118.24-.113.547-.29.893-.533a10.726 10.726 0 0 0 2.287-2.233c1.527-1.997 2.807-5.031 2.253-9.188a.48.48 0 0 0-.328-.39c-.651-.213-1.75-.56-2.837-.855C9.552 1.29 8.531 1.067 8 1.067c-.53 0-1.552.223-2.662.524zM5.072.56C6.157.265 7.31 0 8 0s1.843.265 2.928.56c1.11.3 2.229.655 2.887.87a1.54 1.54 0 0 1 1.044 1.262c.596 4.477-.787 7.795-2.465 9.99a11.775 11.775 0 0 1-2.517 2.453 7.159 7.159 0 0 1-1.048.625c-.28.132-.581.24-.829.24s-.548-.108-.829-.24a7.158 7.158 0 0 1-1.048-.625 11.777 11.777 0 0 1-2.517-2.453C1.928 10.487.545 7.169 1.141 2.692A1.54 1.54 0 0 1 2.185 1.43 62.456 62.456 0 0 1 5.072.56z"/>
                            <path d="M10.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0z"/>
                        </svg>
                        <h3>Keine Cookies</h3>
                        <p>Wir verwenden <strong>keine Cookies</strong> und kein Tracking. Nur Ihre Einstellungen werden lokal in Ihrem Browser gespeichert (LocalStorage).</p>
                    </div>
                </div>

                <!-- Datenschutz-Versprechen: Hervorgehobener Text-Block -->
                <div class="privacy-guarantee">
                    <h3>üíö Unser Versprechen an Sie</h3>
                    <p>Wir nehmen Datenschutz ernst. Diese Anwendung wurde speziell entwickelt, um Ihre sensiblen Bankdaten zu sch√ºtzen. Alle Berechnungen und die XML-Generierung erfolgen direkt in Ihrem Browser ‚Äì <strong>ohne Umwege √ºber Server</strong>. Sie haben die volle Kontrolle √ºber Ihre Daten.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ============================================================
         FOOTER
         ============================================================
         Dunkler Footer mit vier Spalten:
         1. Produktname und Beschreibung
         2. Rechtliche Hinweise (DSGVO, Open Source)
         3. Unterstuetzte SEPA-Formate
         4. Entwickler-Info mit Link

         Darunter: Copyright, Impressum, Datenschutz, GitHub-Link
         ============================================================ -->
    <footer>
            <div class="footer-content">
                <!-- Spalte 1: Produktname -->
                <div class="footer-section">
                    <h3>SEPA-XML Generator</h3>
                    <p>Kostenlos, sicher und einfach zu bedienen</p>
                </div>

                <!-- Spalte 2: Rechtliches -->
                <div class="footer-section">
                    <h4>Rechtliches</h4>
                    <ul>
                        <li>‚úì 100% DSGVO-konform</li>
                        <li>‚úì Keine Datenspeicherung</li>
                        <li>‚úì Open Source</li>
                    </ul>
                </div>

                <!-- Spalte 3: Unterstuetzte Formate -->
                <div class="footer-section">
                    <h4>Unterst√ºtzte Formate</h4>
                    <ul>
                        <li>pain.008.001.02 / .08 (Lastschrift)</li>
                        <li>pain.001.001.03 / .08 / .09 (√úberweisung)</li>
                    </ul>
                </div>

                <!-- Spalte 4: Entwickler -->
                <div class="footer-section">
                    <h4>Entwickelt von</h4>
                    <a href="https://webexperte.berlin" target="_blank" rel="noopener" class="footer-link">
                        <strong>Webexperte.Berlin</strong>
                    </a>
                    <p class="footer-tagline">Ihr Experte f√ºr sichere Webanwendungen</p>
                </div>
            </div>

            <!-- Footer-Bottom: Copyright und rechtliche Links -->
            <div class="footer-bottom">
                <p>&copy; 2025 Webexperte.Berlin | Alle Rechte vorbehalten</p>
                <p class="footer-links">
                    <a href="https://www.webexperte.berlin/impressum.html" target="_blank" rel="noopener">Impressum</a> |
                    <a href="https://www.webexperte.berlin/datenschutz.html" target="_blank" rel="noopener">Datenschutz</a> |
                    <a href="https://github.com/mriege/sepa-xml-generator" target="_blank" rel="noopener">GitHub</a>
                </p>
                <p class="footer-privacy">üîí Ihre Daten bleiben sicher in Ihrem Browser</p>
            </div>
        </footer>

    <!-- Anwendungslogik: Event-Handling, Validierung, XML-Generierung -->
    <script src="sepa-generator.js"></script>
</body>
</html>
